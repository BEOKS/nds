# 분석 패턴 및 휴리스틱

## 목차

1. [키워드 추출 전략](#키워드-추출-전략)
2. [원인 분류](#원인-분류)
3. [정보 충분성 판단 휴리스틱](#정보-충분성-판단-휴리스틱)
4. [점수 산정 세부 기준](#점수-산정-세부-기준)
5. [사용자 피드백 반영 규칙](#사용자-피드백-반영-규칙)

---

## 키워드 추출 전략

### 에러 기반
- Exception/Error 클래스명
- 에러 메시지 텍스트
- 스택 트레이스 파일명/라인

### 기능 기반
- 기능명, API 엔드포인트
- UI 컴포넌트명
- 데이터베이스 테이블/컬럼명

### 추출 우선순위
1. 에러 메시지 내 고유 식별자
2. 파일 경로 및 라인 번호
3. 함수/메서드명
4. 변수명 및 상수값

---

## 원인 분류

| 유형 | 설명 | 검색 패턴 |
|------|------|-----------|
| Logic Error | 조건문, 분기 오류 | if/else, switch, 삼항연산자 |
| Null/Undefined | 값 누락 | optional chaining, null check |
| Type Mismatch | 타입 불일치 | 타입 캐스팅, 변환 함수 |
| Race Condition | 동시성 문제 | async/await, Promise, 락 |
| Resource Leak | 리소스 미해제 | close, dispose, finally |
| Boundary Error | 경계값 오류 | 배열 인덱스, 문자열 슬라이싱 |
| State Corruption | 상태 불일치 | 전역 변수, 싱글톤, 캐시 |
| External Dependency | 외부 의존성 문제 | API 호출, 라이브러리 버전 |

---

## 정보 충분성 판단 휴리스틱

### 필수 정보 (없으면 반드시 질문)

| 정보 유형 | 판단 기준 | 질문 예시 |
|-----------|-----------|-----------|
| 재현 조건 | 보드 카드에 재현 단계 없음 | "이슈가 발생하는 구체적인 단계를 알려주세요" |
| 환경 | 환경별 동작 차이 가능성 있음 | "어떤 환경에서 발생하나요? (개발/스테이징/운영)" |
| 입력 데이터 | 특정 데이터에서만 발생 가능 | "문제가 발생하는 입력 데이터 예시가 있나요?" |
| 발생 빈도 | 간헐적 vs 항상 발생 | "항상 발생하나요, 아니면 간헐적으로 발생하나요?" |

### 정책 관련 질문 (해당 시 질문)

| 상황 | 질문 예시 |
|------|-----------|
| 여러 수정 방법 존재 | "A 방식과 B 방식 중 선호하는 접근법이 있나요?" |
| 하위 호환성 영향 | "기존 API 시그니처 변경이 가능한가요?" |
| 성능 vs 가독성 | "성능과 코드 가독성 중 우선순위는?" |
| DB 스키마 변경 | "DB 스키마 변경이 허용되나요?" |
| 외부 의존성 | "새로운 라이브러리 추가가 가능한가요?" |
| 긴급도 | "긴급 수정이 필요한가요, 아니면 충분히 검토 후 수정해도 되나요?" |

### 제약 조건 탐지 패턴

코드 내 다음 패턴 발견 시 제약 조건 확인 필요:

- `// DO NOT MODIFY` 주석 → 수정 불가 영역
- `@deprecated` → 대체 방안 검토 필요
- `// FIXME`, `// TODO` → 기존 인지된 문제
- `legacy`, `v1`, `old` 네이밍 → 레거시 제약 가능
- `@api-public`, `@external` → 외부 노출 API, 하위 호환성 필요

---

## 점수 산정 세부 기준

### 원인 적합도 (40점 만점)

| 연관성 | 점수 | 설명 |
|--------|------|------|
| 직접 연관 | 40점 | 에러 발생 지점과 직접 연결 |
| 간접 연관 | 25점 | 호출 체인 또는 데이터 흐름으로 연결 |
| 추측 | 10점 | 패턴 기반 추론, 확실하지 않음 |

### 구현 복잡도 (25점 만점)

| 수정 범위 | 점수 | 설명 |
|-----------|------|------|
| 1-5줄 | 25점 | 단순 수정 |
| 6-20줄 | 20점 | 소규모 수정 |
| 21-50줄 | 15점 | 중규모 수정 |
| 50줄 초과 | 5점 | 대규모 수정 |

### 부작용 위험 (20점 만점)

| 영향 범위 | 점수 | 설명 |
|-----------|------|------|
| 단일 함수 | 20점 | 해당 함수 내부만 영향 |
| 단일 모듈 | 15점 | 같은 모듈/파일 내 영향 |
| 다중 모듈 | 10점 | 여러 모듈에 영향 |
| 시스템 전체 | 5점 | 전역적 영향 가능 |

### 테스트 용이성 (15점 만점)

| 테스트 유형 | 점수 | 설명 |
|-------------|------|------|
| 단위 테스트 | 15점 | 독립적 단위 테스트 가능 |
| 통합 테스트 | 10점 | 여러 컴포넌트 연동 테스트 필요 |
| E2E 테스트 | 5점 | 전체 시스템 테스트 필요 |

---

## 사용자 피드백 반영 규칙

### 제약 조건 처리

```
사용자: "X는 수정 불가"
→ X를 수정하는 방안: 점수 0점 (제외)

사용자: "Y 방식 선호"
→ Y 방식 해결방안: +10점 보너스

사용자: "Z 라이브러리 추가 불가"
→ Z 의존 방안: 점수 0점 (제외)
```

### 우선순위에 따른 가중치 조정

| 우선순위 | 가중치 변경 | 이유 |
|----------|-------------|------|
| 긴급 | 구현 복잡도 35%, 원인 적합도 35%, 부작용 15%, 테스트 15% | 빠른 해결 우선 |
| 일반 | 기본 가중치 유지 | 균형 잡힌 판단 |
| 개선 | 부작용 위험 30%, 원인 적합도 35%, 구현 20%, 테스트 15% | 안정성 우선 |

### 복합 제약 조건 처리

여러 제약 조건이 있을 경우:
1. 모든 제약 조건 위반 여부 먼저 확인
2. 하나라도 위반 시 해당 방안 제외
3. 제약 조건 준수 방안 중에서만 점수 비교
