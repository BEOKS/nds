---
name: cve-scan
description: 프로젝트 의존성 취약점(CVE) 스캔. JS/TS/React/Vue/Next/Nuxt(npm audit), Python(pip-audit), Java/Spring(dependency-check), PHP(composer audit) 지원. "취약점 스캔", "CVE 검사", "보안 체크", "dependency audit" 등의 요청 시 사용.
---

# CVE Vulnerability Scanner

프로젝트 의존성의 보안 취약점(CVE)을 스캔하고 리포트를 생성한다.

## 지원 기술스택

| 스택 | 감지 파일 | 스캔 도구 |
|------|----------|----------|
| JS/TS/React/Vue/Next/Nuxt | `package.json` | npm audit / yarn audit |
| Python | `requirements.txt`, `pyproject.toml` | pip-audit |
| Java/Spring | `pom.xml` | mvn dependency:tree + OSV |
| Java/Spring | `build.gradle` | gradle dependencies + OSV |
| PHP | `composer.json` | composer audit |

## 사전 조건

```bash
# Python 프로젝트용
pip install pip-audit

# PHP 프로젝트용 (PHP 8.1+)
composer --version
```

## 워크플로우

### 1. 전체 스캔 (자동 감지)

```bash
python3 scripts/cve_scan.py scan --path /path/to/project
```

### 2. 특정 스택만 스캔

```bash
python3 scripts/cve_scan.py scan --path . --stack npm
python3 scripts/cve_scan.py scan --path . --stack python
python3 scripts/cve_scan.py scan --path . --stack maven
python3 scripts/cve_scan.py scan --path . --stack gradle
python3 scripts/cve_scan.py scan --path . --stack php
```

### 3. 심각도 필터링

```bash
# HIGH 이상만 표시
python3 scripts/cve_scan.py scan --path . --severity high

# CRITICAL만 표시
python3 scripts/cve_scan.py scan --path . --severity critical
```

### 4. JSON 리포트 출력

```bash
python3 scripts/cve_scan.py scan --path . --format json --output report.json
```

## 명령어

| 명령어 | 설명 |
|--------|------|
| `scan` | 취약점 스캔 실행 |
| `detect` | 프로젝트 타입만 감지 (스캔 없이) |

## 옵션 설명

| 옵션 | 설명 |
|------|------|
| `--path` | 스캔할 프로젝트 경로 (기본값: 현재 디렉토리) |
| `--stack` | 특정 스택만 스캔: npm, python, maven, gradle, php |
| `--severity` | 최소 심각도 필터: low, medium, high, critical |
| `--format` | 출력 형식: table (기본), json |
| `--output` | 결과 저장 파일 경로 |
| `--fix` | 자동 수정 시도 (npm audit fix 등) |

## 출력 예시

```
=== CVE Scan Report ===
Project: /path/to/project
Scanned: 2026-02-05 15:00:00

[NPM] 3 vulnerabilities found
┌──────────┬─────────────────┬──────────┬─────────────────────────────┐
│ Severity │ Package         │ CVE      │ Description                 │
├──────────┼─────────────────┼──────────┼─────────────────────────────┤
│ CRITICAL │ lodash@4.17.15  │ CVE-2021-│ Prototype Pollution         │
│ HIGH     │ axios@0.21.0    │ CVE-2021-│ Server-Side Request Forgery │
│ MEDIUM   │ minimist@1.2.5  │ CVE-2021-│ Prototype Pollution         │
└──────────┴─────────────────┴──────────┴─────────────────────────────┘

[Python] 1 vulnerability found
┌──────────┬─────────────────┬──────────┬─────────────────────────────┐
│ Severity │ Package         │ CVE      │ Description                 │
├──────────┼─────────────────┼──────────┼─────────────────────────────┤
│ HIGH     │ requests@2.25.0 │ CVE-2023-│ Unintended Leak of Headers  │
└──────────┴─────────────────┴──────────┴─────────────────────────────┘

Total: 4 vulnerabilities (1 critical, 2 high, 1 medium)
```
